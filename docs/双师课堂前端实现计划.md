# 双师课堂前端实现计划

## 1. 技术栈选型

### 1.1 核心框架
- Vue 3：核心前端框架
- TypeScript：类型系统，提高代码质量和可维护性
- Vue Router：路由管理
- Pinia：状态管理

### 1.2 UI组件库与样式
- TailwindCSS：原子化CSS框架
- Heroicons：图标库
- 自定义组件：基于TailwindCSS构建的业务组件库

### 1.3 工具库
- axios/fetch：网络请求（通过apiClient.ts封装）
- dayjs：日期处理
- vee-validate：表单验证

## 2. 组件化架构

### 2.1 页面组件结构

```
src/
├── views/
│   ├── classroom/
│   │   ├── ClassroomListView.vue          # 课程列表页面
│   │   ├── ClassroomDetailView.vue        # 课程详情页面
│   │   ├── TeacherCourseManager.vue       # 教师课程管理页面
│   │   ├── StudentEnrolledCourses.vue     # 学生已报名课程页面
│   │   └── CourseChapterView.vue          # 课程章节学习页面
```

### 2.2 公共组件结构

```
src/
├── components/
│   ├── classroom/
│   │   ├── CourseCard.vue                 # 课程卡片组件
│   │   ├── CourseFilter.vue               # 课程筛选组件
│   │   ├── CourseForm.vue                 # 课程表单组件
│   │   ├── CourseEnrollButton.vue         # 课程报名按钮组件
│   │   ├── CourseInfo.vue                 # 课程信息展示组件
│   │   ├── CourseResources.vue            # 课程资源列表组件
│   │   ├── ResourceUploader.vue           # 资源上传组件
│   │   ├── StudentsList.vue               # 学生列表组件
│   │   ├── CourseRating.vue               # 课程评价组件
│   │   ├── CourseStatusBadge.vue          # 课程状态徽章组件
│   │   └── CourseChapterList.vue          # 课程章节列表组件
```

### 2.3 API接口结构

```
src/
├── lib/
│   ├── api/
│   │   ├── apiClient.ts                   # API请求客户端
│   │   ├── classroom.ts                   # 双师课堂API
│   │   ├── auth.ts                        # 认证API
│   │   └── types.ts                       # API类型定义
```

## 3. 页面实现规划

### 3.1 课程列表页面 (ClassroomListView.vue)

**功能点**：
- 展示所有可报名的课程
- 搜索和筛选功能
- 分页浏览
- 课程卡片展示

**组件组成**：
- `CourseFilter`：筛选器组件
- `CourseCard`：课程卡片组件
- 分页组件

**实现步骤**：
1. 创建页面基础结构
2. 实现筛选组件
3. 实现课程卡片组件
4. 集成API请求与数据处理
5. 实现分页功能
6. 添加响应式布局

### 3.2 课程详情页面 (ClassroomDetailView.vue)

**功能点**：
- 展示课程详细信息
- 显示教师和企业导师信息
- 课程章节列表
- 课程资源列表
- 学生报名/取消报名功能
- 课程评价展示与提交

**组件组成**：
- `CourseInfo`：课程信息组件
- `CourseChapterList`：章节列表组件
- `CourseResources`：资源列表组件
- `CourseEnrollButton`：报名按钮组件
- `CourseRating`：评价组件

**实现步骤**：
1. 创建页面基础结构
2. 实现课程信息展示区
3. 实现章节列表组件
4. 实现资源列表组件
5. 实现报名功能
6. 实现评价功能
7. 添加响应式布局

### 3.3 教师课程管理页面 (TeacherCourseManager.vue)

**功能点**：
- 展示教师创建的所有课程
- 创建新课程
- 编辑、删除课程
- 上传课程资源
- 查看学生名单
- 修改课程状态

**组件组成**：
- 课程表格组件
- `CourseForm`：课程表单组件
- `ResourceUploader`：资源上传组件
- `StudentsList`：学生列表组件

**实现步骤**：
1. 创建页面基础结构
2. 实现课程列表表格
3. 实现课程创建/编辑表单
4. 实现资源上传功能
5. 实现学生名单查看功能
6. 实现课程状态管理
7. 添加响应式布局

### 3.4 学生已报名课程页面 (StudentEnrolledCourses.vue)

**功能点**：
- 展示学生已报名的课程
- 进入课程学习
- 查看学习进度
- 课程评价

**组件组成**：
- 课程卡片列表
- 进度指示器组件

**实现步骤**：
1. 创建页面基础结构
2. 实现已报名课程列表
3. 实现学习进度展示
4. 实现课程评价入口
5. 添加响应式布局

## 4. 公共组件实现计划

### 4.1 CourseCard.vue

**功能**：展示课程基本信息的卡片组件

**属性**：
- `course`：课程信息对象
- `showActions`：是否显示操作按钮

**事件**：
- `click`：点击卡片
- `enroll`：报名课程
- `view`：查看详情

**实现要点**：
- 响应式设计，适配不同屏幕尺寸
- 显示课程状态、类型、教师信息等
- 根据用户角色和课程状态显示不同的操作按钮

### 4.2 CourseForm.vue

**功能**：创建/编辑课程的表单组件

**属性**：
- `initialValues`：初始表单值
- `isEditing`：是否为编辑模式

**事件**：
- `submit`：提交表单
- `cancel`：取消操作

**实现要点**：
- 表单验证
- 支持企业导师搜索和选择
- 日期时间选择器
- 文件上传组件集成

### 4.3 CourseFilter.vue

**功能**：课程搜索和筛选组件

**属性**：
- `initialFilters`：初始筛选条件

**事件**：
- `apply`：应用筛选条件
- `reset`：重置筛选条件

**实现要点**：
- 关键词搜索
- 课程类型筛选
- 课程状态筛选
- 日期范围筛选
- 响应式布局

### 4.4 CourseResources.vue

**功能**：展示课程资源列表

**属性**：
- `courseId`：课程ID
- `isTeacher`：是否为教师/管理员

**事件**：
- `download`：下载资源
- `delete`：删除资源
- `upload`：上传新资源

**实现要点**：
- 资源类型过滤
- 文件下载功能
- 权限控制
- 分页功能

### 4.5 CourseRating.vue

**功能**：课程评价组件

**属性**：
- `courseId`：课程ID
- `canRate`：是否可以评价

**事件**：
- `rated`：提交评价

**实现要点**：
- 评分功能
- 评价内容输入
- 已有评价展示
- 响应式设计

## 5. 状态管理设计

### 5.1 课程状态管理

```typescript
// 使用Pinia创建课程状态库
export const useCourseStore = defineStore('course', {
  state: () => ({
    courseList: [] as DualTeacherCourseVO[],
    currentCourse: null as DualTeacherCourseVO | null,
    loading: false,
    error: null as string | null,
    filter: {
      keyword: '',
      status: '',
      courseType: '',
      page: 1,
      size: 10
    },
    total: 0
  }),
  
  actions: {
    async fetchCourses() {
      this.loading = true;
      try {
        const response = await getCourses(this.filter);
        this.courseList = response.data.records;
        this.total = response.data.total;
      } catch (error) {
        this.error = getErrorMessage(error);
      } finally {
        this.loading = false;
      }
    },
    
    async getCourseDetail(id: number) {
      this.loading = true;
      try {
        const response = await getCourseById(id);
        this.currentCourse = response.data;
      } catch (error) {
        this.error = getErrorMessage(error);
      } finally {
        this.loading = false;
      }
    },
    
    setFilter(filter: Partial<typeof this.filter>) {
      this.filter = { ...this.filter, ...filter };
    }
  }
});
```

### 5.2 学生报名状态管理

```typescript
export const useEnrollmentStore = defineStore('enrollment', {
  state: () => ({
    enrolledCourses: [] as DualTeacherCourseVO[],
    loading: false,
    error: null as string | null
  }),
  
  actions: {
    async fetchEnrolledCourses() {
      this.loading = true;
      try {
        const response = await getEnrolledCourses();
        this.enrolledCourses = response.data.records;
      } catch (error) {
        this.error = getErrorMessage(error);
      } finally {
        this.loading = false;
      }
    },
    
    async enrollCourse(courseId: number) {
      this.loading = true;
      try {
        await enrollInCourse(courseId);
        await this.fetchEnrolledCourses();
        return true;
      } catch (error) {
        this.error = getErrorMessage(error);
        return false;
      } finally {
        this.loading = false;
      }
    },
    
    async unenrollCourse(courseId: number) {
      this.loading = true;
      try {
        await cancelEnrollment(courseId);
        this.enrolledCourses = this.enrolledCourses.filter(
          course => course.id !== courseId
        );
        return true;
      } catch (error) {
        this.error = getErrorMessage(error);
        return false;
      } finally {
        this.loading = false;
      }
    }
  }
});
```

## 6. 路由配置

```typescript
const routes = [
  {
    path: '/classroom',
    name: 'classroom-list',
    component: ClassroomListView,
    meta: { title: '双师课堂' }
  },
  {
    path: '/classroom/manage',
    name: 'classroom-manage',
    component: TeacherCourseManager,
    meta: { 
      requiresAuth: true,
      roles: ['teacher', 'TEACHER', 'schoolAdmin', 'SCH_ADMIN']
    }
  },
  {
    path: '/classroom/:id',
    name: 'classroom-detail',
    component: ClassroomDetailView,
    props: true,
    meta: { title: '课程详情' }
  },
  {
    path: '/classroom/enrolled',
    name: 'enrolled-courses',
    component: StudentEnrolledCourses,
    meta: { 
      requiresAuth: true,
      roles: ['student', 'STUDENT']
    }
  },
  {
    path: '/classroom/:courseId/chapter/:chapterId',
    name: 'course-chapter',
    component: CourseChapterView,
    props: true,
    meta: { 
      requiresAuth: true,
      title: '课程学习'
    }
  }
];
```

## 7. 开发阶段划分

### 7.1 第一阶段：基础组件与API集成

**目标**：
- 完成核心组件的开发
- 实现API接口对接
- 构建基本页面框架

**任务**：
1. 创建API接口服务
2. 开发基础UI组件
3. 实现状态管理
4. 配置路由系统

**时间估计**：2周

### 7.2 第二阶段：教师管理功能

**目标**：
- 完成教师课程管理页面
- 实现课程创建、编辑、删除功能
- 实现资源上传功能
- 实现学生管理功能

**任务**：
1. 开发TeacherCourseManager页面
2. 实现CourseForm组件
3. 实现ResourceUploader组件
4. 实现StudentsList组件

**时间估计**：2周

### 7.3 第三阶段：学生功能与课程详情

**目标**：
- 完成课程列表和详情页面
- 实现学生报名功能
- 实现课程评价功能

**任务**：
1. 开发ClassroomListView页面
2. 开发ClassroomDetailView页面
3. 实现CourseEnrollButton组件
4. 实现CourseRating组件

**时间估计**：2周

### 7.4 第四阶段：优化与完善

**目标**：
- 性能优化
- 用户体验改进
- 响应式设计完善
- 测试与修复

**任务**：
1. 代码优化与重构
2. UI/UX完善
3. 单元测试
4. 端到端测试
5. 性能测试与优化

**时间估计**：2周

## 8. 跨组件通信方案

### 8.1 组件通信方式

- **父子组件**：Props down, Events up
- **兄弟组件**：通过共同的父组件或Pinia状态库
- **无关联组件**：Pinia状态库

### 8.2 事件总线

对于复杂的跨组件通信，可以使用轻量级的事件总线：

```typescript
// eventBus.ts
import mitt from 'mitt';

type Events = {
  'course-updated': { id: number };
  'enrollment-changed': { courseId: number, action: 'enroll' | 'unenroll' };
  'resource-uploaded': { courseId: number };
};

const eventBus = mitt<Events>();

export default eventBus;
```

## 9. 优化策略

### 9.1 性能优化

1. **组件懒加载**：
   ```typescript
   const TeacherCourseManager = () => import('@/views/classroom/TeacherCourseManager.vue')
   ```

2. **虚拟列表**：对于大量数据的列表，使用虚拟滚动

3. **图片优化**：使用懒加载和合适的图片格式

4. **缓存策略**：对频繁访问的数据进行缓存

### 9.2 用户体验优化

1. **加载状态**：所有异步操作显示加载状态

2. **错误处理**：友好的错误提示和恢复机制

3. **表单交互**：即时表单验证和反馈

4. **操作确认**：重要操作需要确认

5. **响应式设计**：适配不同设备尺寸

## 10. 测试计划

### 10.1 单元测试

使用Vitest进行组件和服务的单元测试：

```typescript
// CourseCard.spec.ts
import { mount } from '@vue/test-utils';
import CourseCard from '@/components/classroom/CourseCard.vue';

describe('CourseCard', () => {
  test('renders course title correctly', () => {
    const course = {
      id: 1,
      title: 'Test Course',
      // ...其他属性
    };
    
    const wrapper = mount(CourseCard, {
      props: { course }
    });
    
    expect(wrapper.text()).toContain('Test Course');
  });
  
  test('emits click event when clicked', async () => {
    const course = { id: 1, title: 'Test Course' };
    const wrapper = mount(CourseCard, {
      props: { course }
    });
    
    await wrapper.trigger('click');
    
    expect(wrapper.emitted('click')).toBeTruthy();
    expect(wrapper.emitted('click')?.[0]).toEqual([course]);
  });
});
```

### 10.2 端到端测试

使用Cypress进行端到端测试：

```typescript
// cypress/e2e/courseList.spec.ts
describe('Course List Page', () => {
  beforeEach(() => {
    cy.login('teacher@example.com', 'password');
    cy.visit('/classroom');
  });
  
  it('displays courses', () => {
    cy.get('[data-test="course-card"]').should('have.length.at.least', 1);
  });
  
  it('filters courses by type', () => {
    cy.get('[data-test="filter-type"]').select('online');
    cy.get('[data-test="apply-filter"]').click();
    cy.get('[data-test="course-card"]').should('contain', 'online');
  });
});
```

## 11. 总结

双师课堂前端实现计划提供了详细的组件设计、页面规划和开发阶段划分。通过组件化的架构和清晰的状态管理，我们可以构建一个功能完善、用户友好的双师课堂系统。该系统将支持教师创建和管理课程、学生浏览和报名课程、上传和下载课程资源，以及课程评价等核心功能。

实现过程将分为四个阶段，从基础组件与API集成开始，逐步完善教师管理功能、学生功能和课程详情，最后进行优化与完善。在开发过程中，我们将注重性能优化、用户体验改进和全面的测试覆盖，确保系统的稳定性和可靠性。 