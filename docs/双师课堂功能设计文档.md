# 双师课堂功能设计文档

## 1. 功能概述

双师课堂是一种由学校教师和企业导师共同参与的教学模式，旨在将理论教学与实践应用相结合，为学生提供更加全面和实用的知识技能培训。在我们的平台中，双师课堂模块支持课程的创建、管理、报名、资源共享和互动交流等功能。

### 1.1 主要功能点

1. **课程管理**：创建、编辑、删除课程，管理课程状态
2. **教师/导师管理**：搜索和指定企业导师，教师与导师协作
3. **学生管理**：学生报名、退课、学生名单管理
4. **资源管理**：上传、下载和管理课程资源
5. **互动功能**：课程评价、讨论区、问答功能
6. **课程进度**：课程章节、学习进度跟踪
7. **数据统计**：出勤率、完成率、评分统计等

## 2. 用户角色与权限

### 2.1 学校教师

- 创建和管理双师课堂
- 搜索和邀请企业导师协作
- 发布课程通知和资源
- 管理学生名单和出勤
- 设置课程章节和进度
- 查看学生评价和反馈

### 2.2 企业导师

- 接受或拒绝教师的协作邀请
- 查看课程信息和学生名单
- 上传实践资源和案例
- 参与在线教学和答疑
- 评价学生作业和项目

### 2.3 学生

- 浏览和搜索课程
- 报名或退出课程
- 下载课程资源
- 提交作业和项目
- 参与课程讨论
- 评价课程和教师/导师

### 2.4 学校管理员

- 审核和管理所有双师课堂
- 管理教师和导师账号
- 查看课程统计数据
- 处理学生申诉和问题

## 3. 数据模型设计

### 3.1 课程 (DualTeacherCourse)

```typescript
interface DualTeacherCourseDTO {
  title: string;               // 课程标题
  description: string;         // 课程描述
  teacherId?: number;          // 教师ID
  mentorId?: number;           // 企业导师ID
  scheduledTime: string;       // 课程计划时间
  maxStudents?: number;        // 最大学生人数
  location?: string;           // 上课地点
  courseType: CourseType;      // 课程类型: 线上/线下/混合
}

interface DualTeacherCourseVO {
  id: number;                  // 课程ID
  title: string;               // 课程标题
  description: string;         // 课程描述
  teacherId: number;           // 教师ID
  teacherName: string;         // 教师姓名
  mentorId: number;            // 企业导师ID
  mentorName: string;          // 企业导师姓名
  enterpriseName: string;      // 企业名称
  scheduledTime: string;       // 课程计划时间
  maxStudents: number;         // 最大学生人数
  enrolledCount: number;       // 已报名学生数
  location: string;            // 上课地点
  courseType: CourseType;      // 课程类型
  status: CourseStatus;        // 课程状态
  createdAt: string;           // 创建时间
}

enum CourseType {
  ONLINE = "online",           // 线上
  OFFLINE = "offline",         // 线下
  HYBRID = "hybrid"            // 混合
}

enum CourseStatus {
  PLANNING = "planning",       // 筹备中
  OPEN = "open",               // 开放报名
  IN_PROGRESS = "in_progress", // 进行中
  COMPLETED = "completed",     // 已结束
  CANCELLED = "cancelled"      // 已取消
}
```

### 3.2 课程报名 (CourseEnrollment)

```typescript
interface CourseEnrollmentDTO {
  courseId: number;            // 课程ID
}

interface CourseEnrollmentVO {
  id: number;                  // 报名记录ID
  courseId: number;            // 课程ID
  courseTitle: string;         // 课程标题
  studentId: number;           // 学生ID
  studentName: string;         // 学生姓名
  enrollTime: string;          // 报名时间
  status: string;              // 状态: enrolled/completed/cancelled
}
```

### 3.3 课程资源 (CourseResource)

```typescript
interface CourseResourceDTO {
  courseId: number;            // 课程ID
  title: string;               // 资源标题
  description: string;         // 资源描述
  resourceType: string;        // 资源类型: document/video/code/other
}

interface CourseResourceVO {
  id: number;                  // 资源ID
  courseId: number;            // 课程ID
  courseTitle: string;         // 课程标题
  uploaderId: number;          // 上传者ID
  uploaderName: string;        // 上传者姓名
  title: string;               // 资源标题
  description: string;         // 资源描述
  resourceType: string;        // 资源类型
  fileUrl: string;             // 文件URL
  fileSize: number;            // 文件大小
  downloadCount: number;       // 下载次数
  uploadTime: string;          // 上传时间
}
```

### 3.4 课程评价 (CourseRating)

```typescript
interface CourseRatingDTO {
  courseId: number;            // 课程ID
  rating: number;              // 评分(1-5)
  content: string;             // 评价内容
}

interface CourseRatingVO {
  id: number;                  // 评价ID
  courseId: number;            // 课程ID
  courseTitle: string;         // 课程标题
  studentId: number;           // 学生ID
  studentName: string;         // 学生姓名
  rating: number;              // 评分
  content: string;             // 评价内容
  createdAt: string;           // 创建时间
  updatedAt: string;           // 更新时间
}
```

### 3.5 课程章节 (CourseChapter)

```typescript
interface CourseChapterDTO {
  courseId: number;            // 课程ID
  title: string;               // 章节标题
  description: string;         // 章节描述
  sort: number;                // 排序顺序
}

interface CourseChapterVO {
  id: number;                  // 章节ID
  courseId: number;            // 课程ID
  title: string;               // 章节标题
  description: string;         // 章节描述
  sort: number;                // 排序顺序
  resourceCount: number;       // 资源数量
  createdAt: string;           // 创建时间
  updatedAt: string;           // 更新时间
}
```

## 4. API接口设计

### 4.1 课程管理接口

#### 4.1.1 创建课程

- **请求方法**: POST
- **URL**: `/v1/dual-courses`
- **请求体**: `DualTeacherCourseDTO`
- **响应**: `ApiResponse<DualTeacherCourseVO>`
- **权限**: 教师、学校管理员

#### 4.1.2 获取课程列表

- **请求方法**: GET
- **URL**: `/v1/dual-courses`
- **查询参数**: `page`, `size`, `keyword`, `status`, `courseType`
- **响应**: `ApiResponse<PagedResponse<DualTeacherCourseVO>>`
- **权限**: 所有用户

#### 4.1.3 获取课程详情

- **请求方法**: GET
- **URL**: `/v1/dual-courses/{id}`
- **响应**: `ApiResponse<DualTeacherCourseVO>`
- **权限**: 所有用户

#### 4.1.4 更新课程

- **请求方法**: PUT
- **URL**: `/v1/dual-courses/{id}`
- **请求体**: `DualTeacherCourseDTO`
- **响应**: `ApiResponse<DualTeacherCourseVO>`
- **权限**: 课程创建者、学校管理员

#### 4.1.5 删除课程

- **请求方法**: DELETE
- **URL**: `/v1/dual-courses/{id}`
- **响应**: `ApiResponse<null>`
- **权限**: 课程创建者、学校管理员

#### 4.1.6 更新课程状态

- **请求方法**: PATCH
- **URL**: `/v1/dual-courses/{id}/status`
- **查询参数**: `status`
- **响应**: `ApiResponse<null>`
- **权限**: 课程创建者、学校管理员

#### 4.1.7 获取教师创建的课程

- **请求方法**: GET
- **URL**: `/v1/dual-courses/teacher`
- **查询参数**: `page`, `size`
- **响应**: `ApiResponse<PagedResponse<DualTeacherCourseVO>>`
- **权限**: 教师

#### 4.1.8 获取可报名的课程列表

- **请求方法**: GET
- **URL**: `/v1/dual-courses/enrollable`
- **查询参数**: `page`, `size`, `keyword`, `courseType`
- **响应**: `ApiResponse<PagedResponse<DualTeacherCourseVO>>`
- **权限**: 所有用户

### 4.2 报名管理接口

#### 4.2.1 学生报名课程

- **请求方法**: POST
- **URL**: `/v1/dual-courses/enroll`
- **请求体**: `CourseEnrollmentDTO`
- **响应**: `ApiResponse<null>`
- **权限**: 学生

#### 4.2.2 学生取消报名

- **请求方法**: DELETE
- **URL**: `/v1/dual-courses/enroll/{courseId}`
- **响应**: `ApiResponse<null>`
- **权限**: 学生

#### 4.2.3 获取学生已报名的课程列表

- **请求方法**: GET
- **URL**: `/v1/dual-courses/enrolled`
- **查询参数**: `page`, `size`
- **响应**: `ApiResponse<PagedResponse<DualTeacherCourseVO>>`
- **权限**: 学生

#### 4.2.4 更新学生选课状态

- **请求方法**: PATCH
- **URL**: `/v1/dual-courses/enrollment/{enrollmentId}/status`
- **查询参数**: `status` (enrolled/cancelled/completed)
- **响应**: `ApiResponse<null>`
- **权限**: 教师、学校管理员

#### 4.2.5 获取课程的学生列表

- **请求方法**: GET
- **URL**: `/v1/dual-courses/{courseId}/students`
- **响应**: `ApiResponse<Array<{id: number, name: string, email?: string, studentId?: string, enrollTime: string, status: string}>>`
- **权限**: 课程教师、企业导师、学校管理员

### 4.3 资源管理接口

#### 4.3.1 上传课程资源

- **请求方法**: POST
- **URL**: `/v1/course-resources`
- **请求体**: `multipart/form-data` (包含文件和 `CourseResourceDTO` JSON)
- **响应**: `ApiResponse<CourseResourceVO>`
- **权限**: 课程教师、企业导师

#### 4.3.2 获取课程资源列表

- **请求方法**: GET
- **URL**: `/v1/course-resources/course/{courseId}`
- **查询参数**: `page`, `size`, `resourceType`
- **响应**: `ApiResponse<PagedResponse<CourseResourceVO>>`
- **权限**: 课程相关人员

#### 4.3.3 下载课程资源

- **请求方法**: GET
- **URL**: `/v1/course-resources/{resourceId}/download`
- **响应**: 文件流
- **权限**: 课程相关人员

#### 4.3.4 删除课程资源

- **请求方法**: DELETE
- **URL**: `/v1/course-resources/{resourceId}`
- **响应**: `ApiResponse<null>`
- **权限**: 资源上传者、课程教师、学校管理员

### 4.4 评价管理接口

#### 4.4.1 提交课程评价

- **请求方法**: POST
- **URL**: `/v1/course-ratings`
- **请求体**: `CourseRatingDTO`
- **响应**: `ApiResponse<CourseRatingVO>`
- **权限**: 已完成课程的学生

#### 4.4.2 获取课程评价列表

- **请求方法**: GET
- **URL**: `/v1/course-ratings/course/{courseId}`
- **查询参数**: `page`, `size`
- **响应**: `ApiResponse<PagedResponse<CourseRatingVO>>`
- **权限**: 所有用户

#### 4.4.3 获取课程平均评分

- **请求方法**: GET
- **URL**: `/v1/course-ratings/average/{courseId}`
- **响应**: `ApiResponse<number>`
- **权限**: 所有用户

#### 4.4.4 检查学生是否已评价课程

- **请求方法**: GET
- **URL**: `/v1/course-ratings/check/{courseId}`
- **响应**: `ApiResponse<boolean>`
- **权限**: 学生

### 4.5 用户相关接口

#### 4.5.1 搜索用户

- **请求方法**: GET
- **URL**: `/v1/auth/search`
- **查询参数**: `keyword` (邮箱或手机号)
- **响应**: `ApiResponse<UserVO>`
- **权限**: 教师、学校管理员

## 5. 页面设计

### 5.1 课程列表页面

- **路由**: `/classroom`
- **组件**: `ClassroomListView.vue`
- **功能**:
  - 展示所有可报名的课程
  - 支持搜索和筛选
  - 课程卡片展示基本信息
  - 分页浏览

### 5.2 课程详情页面

- **路由**: `/classroom/:id`
- **组件**: `ClassroomDetailView.vue`
- **功能**:
  - 展示课程详细信息
  - 显示教师和企业导师信息
  - 课程章节和资源列表
  - 学生报名/取消报名按钮
  - 课程评价展示和提交

### 5.3 教师课程管理页面

- **路由**: `/classroom/manage`
- **组件**: `TeacherCourseManager.vue`
- **功能**:
  - 展示教师创建的所有课程
  - 创建新课程按钮
  - 编辑、删除课程操作
  - 上传课程资源
  - 查看学生名单
  - 修改课程状态

### 5.4 学校管理员课程管理页面

- **路由**: 集成在 `/dashboard/school` 的标签页中
- **组件**: 在 `SchoolAdminDashboard.vue` 中集成
- **功能**:
  - 管理所有课程
  - 审核课程操作
  - 查看统计数据

### 5.5 学生已报名课程页面

- **路由**: 集成在 `/dashboard/student` 中
- **组件**: 在 `StudentDashboard.vue` 中集成
- **功能**:
  - 展示已报名课程
  - 查看学习进度
  - 进入课程学习

## 6. 组件设计

### 6.1 课程管理组件

- **TeacherCourseManager.vue**: 课程管理表格组件
  - 功能: 展示课程列表，提供各种操作按钮，支持分页
  - 属性: courseList, loading, error, currentPage, pageSize, total
  - 事件: edit, delete, upload-resource, view-students, page-change, status-change

### 6.2 课程展示组件

- **CourseCard.vue**: 课程卡片组件
  - 功能: 在列表页展示课程基本信息
  - 属性: course
  - 事件: click

- **CourseInfo.vue**: 课程详细信息组件
  - 功能: 在详情页展示课程详细信息
  - 属性: course

### 6.3 课程筛选组件

- **CourseFilter.vue**: 课程筛选组件
  - 功能: 提供搜索框和筛选条件
  - 属性: initialFilters
  - 事件: apply, reset

### 6.4 课程资源组件

- **CourseResources.vue**: 课程资源列表组件
  - 功能: 展示课程资源，提供下载功能
  - 属性: courseId, isTeacher

- **ResourceUploader.vue**: 资源上传组件
  - 功能: 上传课程资源
  - 属性: courseId
  - 事件: uploaded

### 6.5 评价组件

- **CourseRating.vue**: 课程评价组件
  - 功能: 展示课程评价，提交新评价
  - 属性: courseId, canRate
  - 事件: rated

### 6.6 报名相关组件

- **CourseEnrollButton.vue**: 课程报名按钮组件
  - 功能: 根据课程状态和用户状态显示不同的按钮
  - 属性: course, isEnrolled
  - 事件: enroll, unenroll

## 7. 状态流转

### 7.1 课程状态流转

1. **筹备中 (Planning)**
   - 初始状态，课程刚创建时
   - 可以编辑课程信息
   - 不对学生可见

2. **开放报名 (Open)**
   - 课程信息确定，开始接受学生报名
   - 学生可以查看和报名
   - 仍可以上传课程资源

3. **进行中 (In Progress)**
   - 报名截止，课程开始进行
   - 已报名学生可以访问所有资源
   - 可以记录学生出勤和进度

4. **已结束 (Completed)**
   - 课程教学活动结束
   - 学生可以提交课程评价
   - 资源仍可访问，但不能再报名

5. **已取消 (Cancelled)**
   - 课程因故取消
   - 不对新学生可见
   - 已报名学生收到通知

### 7.2 报名状态流转

1. **已报名 (Enrolled)**
   - 学生成功报名课程
   - 可以访问课程资源
   - 可以取消报名（如果课程未开始）

2. **已完成 (Completed)**
   - 学生完成所有课程要求
   - 可以提交课程评价
   - 课程在学生记录中显示为已完成

3. **已取消 (Cancelled)**
   - 学生取消报名
   - 或管理员/教师取消学生的报名
   - 失去访问课程资源的权限

## 8. 实现计划

### 8.1 前端实现

1. **基础组件开发**
   - 设计并实现所有必要的UI组件
   - 确保组件的可复用性和一致性

2. **页面开发**
   - 课程列表页面
   - 课程详情页面
   - 教师课程管理页面
   - 学生课程学习页面

3. **路由配置**
   - 设置所有必要的路由
   - 配置路由守卫确保权限控制

4. **API集成**
   - 与后端API对接
   - 处理数据加载、提交和错误情况

5. **用户体验优化**
   - 添加加载状态和错误处理
   - 优化页面响应性和交互

### 8.2 后端实现

1. **数据模型**
   - 创建所有必要的数据库表
   - 配置实体间的关系

2. **API开发**
   - 实现所有必要的API端点
   - 添加适当的请求验证和错误处理

3. **权限控制**
   - 实现基于角色的访问控制
   - 确保数据安全和隐私

4. **文件存储**
   - 设置课程资源的文件存储
   - 实现安全的文件上传和下载

5. **业务逻辑**
   - 实现课程和报名的状态管理
   - 处理各种业务场景和边缘情况

## 9. 开发注意事项

1. **用户体验**
   - 确保页面加载速度和响应性
   - 提供清晰的用户引导和错误提示
   - 支持移动设备适配

2. **数据安全**
   - 保护用户个人信息
   - 防止未授权访问课程资源
   - 确保API调用的安全性

3. **性能优化**
   - 优化资源加载和管理
   - 考虑大量课程和学生情况下的性能
   - 实现适当的缓存策略

4. **可扩展性**
   - 设计考虑未来功能扩展
   - 组件化和模块化架构
   - 良好的代码组织和文档

5. **测试与质量保证**
   - 编写单元测试和集成测试
   - 进行用户测试和性能测试
   - 实现错误监控和日志记录

## 10. 未来扩展功能

1. **直播课堂**
   - 集成视频直播功能
   - 支持实时互动和问答

2. **作业管理**
   - 教师发布作业
   - 学生提交作业
   - 在线批改和反馈

3. **证书系统**
   - 课程完成证书生成
   - 证书验证和分享

4. **数据分析**
   - 课程效果分析
   - 学生学习行为分析
   - 教学质量评估

5. **社区互动**
   - 课程讨论区
   - 学习小组
   - 师生互动平台

## 11. 总结

双师课堂功能模块是一个复杂而重要的系统，它将学校教育与企业实践相结合，为学生提供更加全面和实用的学习体验。通过精心设计的用户界面、清晰的数据模型和全面的API支持，我们可以实现一个功能强大、用户友好的双师课堂系统。

本文档提供了对双师课堂功能的全面分析和设计，包括功能需求、数据模型、API接口、页面设计、组件设计以及实现计划。按照这个设计方案进行开发，可以确保系统的完整性、一致性和可扩展性，为用户提供优质的教育体验。 